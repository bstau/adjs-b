var VALID_MESSAGES = [
    {msg: '00C18C907F3101',
     properties: {df: DF_TCAS_SHORT, aa: 0xa4b583, ap: 0xa4b583,
                  vs: VS_AIRBORNE, x0: 0x18, ri: 3, x1: 0, ac: 0xC90}},
    {msg: '010E2DAEB28B94',
     properties: {df: DF_TCAS_SHORT, vs: VS_AIRBORNE, x0: 0x21,
                  ri: RI_MAX_AIRSPEED_LE_600KT, x1: 1, ac: 0xDAE,
                  aa: 0xA5ADF1, ap: 0xA5ADF1}},
    {msg: '02000236E1E03E', 
     properties: {df: DF_TCAS_SHORT, aa: 0xAB04DD, ap: 0xAB04DD,
                  vs: VS_AIRBORNE, x0: 0x40, ri: 0, x1: 0, ac: 0x236}},
    {msg: '024100BF8A2713', 
     properties: {df: DF_TCAS_SHORT, aa: 0xA37646, ap: 0xA37646,
                  vs: VS_AIRBORNE, x0: 0x48, ri: 2, x1: 0, ac: 0xBF}},
    {msg: '020613B5D68962', 
     properties: {df: DF_TCAS_SHORT, aa: 0xA6AF55, ap: 0xA6AF55,
                  vs: VS_AIRBORNE, x0: 0x40, ri: RI_MAX_AIRSPEED_LE_600KT,
                  x1: 0, ac: 0x13B5}},
    {msg: '02818290FED20B', 
     properties: {df: DF_TCAS_SHORT, aa: 0xAC157D, ap: 0xAC157D,
                  vs: VS_AIRBORNE, x0: 0x50, ri: 3, x1: 0, ac: 0x290}},
    {msg: '02A183B0B042C0', 
     properties: {df: DF_TCAS_SHORT, aa: 0xA835AF, ap: 0xA835AF,
                  vs: VS_AIRBORNE, x0: 0x54, ri: 3, x1: 0, ac: 0x3B0}},
    {msg: '02C18699BB3A96', 
     properties: {df: DF_TCAS_SHORT, aa: 0xA4B7D7, ap: 0xA4B7D7,
                  vs: VS_AIRBORNE, x0: 0x58, ri: 3, x1: 0, ac: 0x699}},
    {msg: '02E612120EA948', 
     properties: {df: DF_TCAS_SHORT, aa: 0xAC157D, ap: 0xAC157D,
                  vs: VS_AIRBORNE, x0: 0x5C, ri: RI_MAX_AIRSPEED_LE_600KT,
                  x1: 0, ac: 0x1212}},
    {msg: '0336F947B1C76B', 
     properties: {df: DF_TCAS_SHORT, aa: 0xA037DA, ap: 0xA037DA,
                  vs: VS_AIRBORNE, x0: 0x66, ri: RI_MAX_AIRSPEED_LE_1200KT,
                  x1: 3, ac: 0x1947}},

    {msg: '1F84FF03EFD007', 
     properties: {df: 3}},

    {msg: '200001B3DCF7BE',
     properties: {df: DF_SURV_ALTITUDE_REPLY, aa: 0xAB53DB, ap: 0xAB53DB,
                  fs: FS_AIRBORNE, dr: DR_NO_REQUEST, um: 0, ac: 0x1B3}},
    {msg: '20000611F0EBD7',
     properties: {df: DF_SURV_ALTITUDE_REPLY, aa: 0xABB459, ap: 0xABB459,
                  fs: FS_AIRBORNE, dr: DR_NO_REQUEST, um: 0, ac: 0x611}},
    {msg: '20281332F37777',
     properties: {df: DF_SURV_ALTITUDE_REPLY, aa: 0xAB3CFA, ap: 0xAB3CFA,
                  fs: FS_AIRBORNE, dr: 5, um: 0, ac: 0x1332}},
    {msg: '220002979851CA',
     properties: {df: DF_SURV_ALTITUDE_REPLY, aa: 0xABE00F, ap: 0xABE00F,
                  fs: FS_ALERT_AIRBORNE, dr: DR_NO_REQUEST, um: 0, ac: 0x297}},
    {msg: '22F7FC31432BC7',
     properties: {df: DF_SURV_ALTITUDE_REPLY, aa: 0xA0D561, ap: 0xA0D561,
                  fs: FS_ALERT_AIRBORNE, dr: 0x1E, um: 0x3F, ac: 0x1C31}},
    {msg: '2400031A96E933',
     properties: {df: DF_SURV_ALTITUDE_REPLY, aa: 0xABE00F, ap: 0xABE00F,
                  fs: FS_ALERT_SPI, dr: DR_NO_REQUEST, um: 0, ac: 0x31A}},
    {msg: '25000192A4313F',
     properties: {df: DF_SURV_ALTITUDE_REPLY, aa: 0xA9A8FC, ap: 0xA9A8FC,
                  fs: FS_SPI, dr: DR_NO_REQUEST, um: 0, ac: 0x192}},
    {msg: '2657A1DB9C7CC7',
     properties: {df: DF_SURV_ALTITUDE_REPLY, aa: 0xA0205C, ap: 0xA0205C,
                  fs: 6, dr: 10, um: 61, ac: 0x1DB}},

    {msg: '2800191E164006',
     properties: {df: DF_SURV_MODE_A_ID, aa: 0xA835D1, ap: 0xA835D1,
                  fs: FS_AIRBORNE, dr: DR_NO_REQUEST, um: 0, id: 0x191E}},
    {msg: '28280F2D088EF1',
     properties: {df: DF_SURV_MODE_A_ID, aa: 0xA7197D, ap: 0xA7197D,
                  fs: FS_AIRBORNE, dr: 5, um: 0, id: 0xF2D}},
    {msg: '284A7F9A867A1C',
     properties: {df: DF_SURV_MODE_A_ID, aa: 0xA622FE, ap: 0xA622FE,
                  fs: FS_AIRBORNE, dr: 9, um: 0x13, id: 0x1F9A}},
    {msg: '2A000F2C8B6113',
     properties: {df: DF_SURV_MODE_A_ID, aa: 0xA72611, ap: 0xA72611,
                  fs: FS_ALERT_AIRBORNE, dr: 0, um: 0, id: 0xF2C}},
    {msg: '2C00083FAA80AD',
     properties: {df: DF_SURV_MODE_A_ID, aa: 0xABE00F, ap: 0xABE00F,
                  fs: FS_ALERT_SPI, dr: 0, um: 0, id: 0x83F}},

    {msg: '4B2C9F467F8D1F', properties: {df: 9}},

    {msg: '59A420206CBE67',
     properties: {df: DF_ALL_CALL_REPLY, aa: 0xA42020, ap: 0xA42020,
                  ca: CA_COMM_A_B_REPORT, crc: 0}},
    {msg: '59DEE68753D6E4',
     properties: {df: DF_ALL_CALL_REPLY, aa: 0xDEE687, ap: 0xDEE687,
                  ca: CA_COMM_A_B_REPORT, crc: 0}},
    {msg: '5B9501729D9E93',
     properties: {df: DF_ALL_CALL_REPLY, aa: 0x950172, ap: 0x950172,
                  ca: CA_COMM_A_B_C_D_REPORT, crc: 0}},
    {msg: '5DA77A4FD8F262',
     properties: {df: DF_ALL_CALL_REPLY, aa: 0xA77A4F, ap: 0xA77A4F,
                  ca: CA_MODE_S_LEVEL_2_AIRBORNE, crc: 0}},
    {msg: '5DC01F534204C7',
     properties: {df: DF_ALL_CALL_REPLY, aa: 0xC01F53, ap: 0xC01F53,
                  ca: CA_MODE_S_LEVEL_2_AIRBORNE, crc: 0}},
    {msg: '5FAAD9850A84F3',
     properties: {df: DF_ALL_CALL_REPLY, aa: 0xAAD985, ap: 0xAAD985,
                  ca: CA_DOWNLINK_PENDING_ALERT_OR_SPI, crc: 0}},
    {msg: '5FAC7EE7C95713',
     properties: {df: DF_ALL_CALL_REPLY, aa: 0xAC7EE7, ap: 0xAC7EE7,
                  ca: CA_DOWNLINK_PENDING_ALERT_OR_SPI, crc: 0}},

    // DF_EXT_SQUITTER
    {msg: '8D71BE09F8010000003928B7FB5B',
     properties: {df: DF_EXT_SQUITTER, aa: 0x71BE09, ap: 0x71BE09, 
                  tc: TC_AIRCRAFT_OP_STATUS}},
    {msg: '8D780AE699450E35C0042788AB3B',
     properties: {df: DF_EXT_SQUITTER, aa: 0x780AE6, ap: 0x780AE6, 
                  tc: TC_AIRBORNE_VELOCITY, st: 1, ic: 0, resv_a: 1,
                  nac: 0, we_sign: 1, we: 0x10E, ns_sign: 0, ns: 0x1ae,
                  vrsrc: 0, vr_sign: 0, vr: 1, resv_b: 0, baro_diff_sign: 0,
                  baro_diff: 0x27}},
    {msg: '8DA0C5C699105D99384C0CA7019F',
     properties: {df: DF_EXT_SQUITTER, aa: 0xA0C5C6, ap: 0xA0C5C6, 
                  tc: TC_AIRBORNE_VELOCITY, st: 1, ic: 0, resv_a: 0, nac: 2,
                  we_sign: 0, we: 0x5d, ns_sign: 1, ns: 0xc9, vrsrc: 1,
                  vr_sign: 1, vr: 0x13, resv_b: 0, baro_diff_sign: 0,
                  baro_diff: 0xc}},
    {msg: '8DA037DA25184633C31CA030D5AA',
     properties: {df: DF_EXT_SQUITTER, aa: 0xA037DA, ap: 0xA037DA, 
                  tc: TC_AIRCRAFT_IDENTIFICATION_4, callsign: 'FDX3012 '}},
    {msg: '8DA037DA99099705F08C1150E3B9',
     properties: {df: DF_EXT_SQUITTER, aa: 0xA037DA, ap: 0xA037DA, 
                  tc: TC_AIRBORNE_VELOCITY, st: 1, ic: 0, resv_a: 0, nac: 1,
                  we_sign: 0, we: 0x197, ns_sign: 0, ns: 0x02F, vrsrc: 1,
                  vr_sign: 0, vr: 0x23, resv_b: 0, baro_diff_sign: 0,
                  baro_diff: 0x11}},
    {msg: '8DA037DAE1168A000000003EEF36',
     properties: {df: DF_EXT_SQUITTER, aa: 0xA037DA, ap: 0xA037DA, 
                  tc: TC_EXTENDED_SQUITTER_AC_STATUS}},
    {msg: '8DA037DAEA040876CD3C08186D9D',
     properties: {df: DF_EXT_SQUITTER, aa: 0xA037DA, ap: 0xA037DA, 
                  tc: TC_TARGET_STATUS}},
    {msg: '8DA0A457234CB5F5CB7DA06CD5C2',
     properties: {df: DF_EXT_SQUITTER, aa: 0xA0A457, ap: 0xA0A457, 
                  tc: TC_AIRCRAFT_IDENTIFICATION_4, callsign: 'SKW5276 '}},
    {msg: '8DACF9755851A48A42BD6030E9D2',
     properties: {df: DF_EXT_SQUITTER, aa: 0xACF975, ap: 0xACF975, 
                  tc: TC_AIRBORNE_POSITION_11}},
    {msg: '8DAD15CF581FB0F48E29AE35D958',
     properties: {df: DF_EXT_SQUITTER, aa: 0xAD15CF, ap: 0xAD15CF, 
                  tc: TC_AIRBORNE_POSITION_11}},
    {msg: '8DABE00F9940F2A0A100179D5238',
     properties: {df: DF_EXT_SQUITTER, aa: 0xABE00F, ap: 0xABE00F, 
                  tc: TC_AIRBORNE_VELOCITY, st: 1, ic: 0, resv_a: 1, nac: 0,
                  we_sign: 0, we: 0x0f2, ns_sign: 1, ns: 0x105, vrsrc: 0,
                  vr_sign: 0, vr: 0x040, resv_b: 0, baro_diff_sign: 0,
                  baro_diff: 0x17}},

    // DF_COMM_B_ALT
    {msg: 'A028121C020100000000007B20E6',
     properties: {df: DF_COMM_B_ALT, fs: FS_AIRBORNE, dr: 5, um: 0, ac: 0x121c,
                  mb: [0x02, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00],
                  aa: 0xAB3CFA, ap: 0xAB3CFA}},
    {msg: 'A763E7129376B3215BB5147AC6C5',
     properties: {df: DF_COMM_B_ALT, fs: 7, dr: 12, um: 31, ac: 0x712,
                  mb: [0x93, 0x76, 0xb3, 0x21, 0x5b, 0xb5, 0x14],
                  aa: 0xAD57BB, ap: 0xAD57BB}},
    {msg: 'A7200D1E4853F2943E0608866FD8',
     properties: {df: DF_COMM_B_ALT, fs: 7, dr: 4, um: 0, ac: 0xd1e,
                  mb: [0x48, 0x53, 0xf2, 0x94, 0x3e, 0x06, 0x08],
                  aa: 0xAA77C0, ap: 0xAA77C0}},
    {msg: 'A0000FB820541331CB1CA0DA96CE',
     properties: {df: DF_COMM_B_ALT, fs: FS_AIRBORNE, dr: DR_NO_REQUEST, um: 0,
                  ac: 0xfb8, mb: [0x20, 0x54, 0x13, 0x31, 0xcb, 0x1c, 0xa0],
                  aa: 0xA494EB, ap: 0xA494EB}},
    {msg: 'A0000BB920541331D31CA08A25E5',
     properties: {df: DF_COMM_B_ALT, fs: FS_AIRBORNE, dr: DR_NO_REQUEST, um: 0,
                  ac: 0xbb9, mb: [0x20, 0x54, 0x13, 0x31, 0xd3, 0x1c, 0xa0],
                  aa: 0xA5A2CC, ap: 0xA5A2CC}},
    {msg: 'A0000B9010030A80E50000615BB0',
     properties: {df: DF_COMM_B_ALT, fs: FS_AIRBORNE, dr: DR_NO_REQUEST, um: 0,
                  ac: 0xb90, mb: [0x10, 0x03, 0x0a, 0x80, 0xe5, 0x00, 0x00],
                  aa: 0xA07BB3, ap: 0xA07BB3}},

    // DF_COMM_B_MODE_A_ID
    {msg: 'A80002AC10030A80F600004D70C9',
     properties: {df: DF_COMM_B_MODE_A_ID, fs: FS_AIRBORNE, dr: DR_NO_REQUEST,
                  um: 0, id: 0x2ac, bds: BDS_DATA_LINK_CAPABILITY,
                  aa: 0xA19E61, ap: 0xA19E61}},
    {msg: 'A8000A1910010080F6000059C8C0',
     properties: {df: DF_COMM_B_MODE_A_ID, fs: FS_AIRBORNE, dr: DR_NO_REQUEST,
                  um: 0, id: 0xa19, bds: BDS_DATA_LINK_CAPABILITY,
                  aa: 0xA71B43, ap: 0xA71B43}},
    {msg: 'A8001F0D10010080E60000A56171',
     properties: {df: DF_COMM_B_MODE_A_ID, fs: FS_AIRBORNE, dr: DR_NO_REQUEST,
                  um: 0, id: 0x1f0d, bds: BDS_DATA_LINK_CAPABILITY,
                  aa: 0xA68DDB, ap: 0xA68DDB}},
    {msg: 'A8201B2A10010680E20000A954BA',
     properties: {df: DF_COMM_B_MODE_A_ID, fs: FS_AIRBORNE, dr: 4, um: 0,
                  id: 0x1b2a, bds: BDS_DATA_LINK_CAPABILITY,
                  aa: 0xA37646, ap: 0xA37646}},
    {msg: 'A8280F9E1001000004000062D1D3',
     properties: {df: DF_COMM_B_MODE_A_ID, fs: FS_AIRBORNE, dr: 5, um: 0,
                  id: 0xf9e, bds: BDS_DATA_LINK_CAPABILITY,
                  aa: 0xA72E69, ap: 0xA72E69}},
    {msg: 'A8001F2C203B7D9242082074CEE2',
     properties: {df: DF_COMM_B_MODE_A_ID, fs: FS_AIRBORNE, dr: 0, um: 0,
                  id: 0x1f2c, bds: BDS_AIRCRAFT_IDENTITY,
                  aa: 0xAA40B4, ap: 0xAA40B4}},

    // DF_COMM_D_ELM
    {msg: 'C83E05D8DFE5F1DF0DCC3F034110',
     properties: {df: DF_COMM_D_ELM + 1, ap: 0, aa: 0, x0: 0, ke: 0, nd: 8,
                  md: [0x3e, 0x05, 0xd8, 0xdf, 0xe5, 0xf1, 0xdf, 0x0d, 0xcc,
                       0x3f]}},
    {msg: 'CA773A7E441E009453BA8B581BBA',
     properties: {df: DF_COMM_D_ELM + 1, ap: 0, aa: 0, x0: 0, ke: 0, nd: 0xA,
                  md: [0x77, 0x3a, 0x7e, 0x44, 0x1e, 0x00, 0x94, 0x53, 0xba,
                       0x8b]}},
    {msg: 'CE3EE0A1DC459C0FE719FD84C119',
     properties: {df: DF_COMM_D_ELM + 1, ap: 0, aa: 0, x0: 0, ke: 0, nd: 14,
                  md: [0x3e, 0xe0, 0xa1, 0xdc, 0x45, 0x9c, 0x0f, 0xe7, 0x19,
                       0xfd]}},
];

testThat('Decodes valid Mode S messages into fields', VALID_MESSAGES.every(
    function(input) {
        var isOK = true;
        var msg = new ModeSMessage(314, fromHexBuf(input.msg));
        assertEqual('ModeSMessage("' + input.msg + '").timestamp', 314, msg.timestamp);
        for (var propName in input.properties) {
            isOK &= assertEqual('ModeSMessage("' + input.msg + '").' + propName,
                                input.properties[propName], msg[propName]);
        }
        return isOK;
    }));
